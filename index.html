<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FNaF: UNSETTLED</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; font-family: 'Segoe UI', sans-serif; }
        
        /* Overlay de Transição e Título */
        #black-screen {
            position: absolute; width: 100%; height: 100%; background: #000;
            display: none; justify-content: center; align-items: center; z-index: 100; opacity: 0;
            transition: opacity 2s ease;
        }
        #game-title-intro { color: #cc0000; font-size: 2.5rem; letter-spacing: 10px; display: none; }

        /* Menu Inicial */
        #menu-container {
            position: absolute; width: 100%; height: 100%; display: flex;
            flex-direction: column; justify-content: center; align-items: center;
            z-index: 10; background: #000;
        }
        h1 { color: #fff; font-size: 2rem; letter-spacing: 5px; animation: flicker 3s infinite; }
        .btn-jogar { padding: 15px 40px; background: none; color: #fff; border: 1px solid #444; cursor: pointer; }

        @keyframes flicker { 0%, 18%, 22%, 100% { opacity: 1; } 20% { opacity: 0.2; } }
    </style>
</head>
<body>

    <div id="black-screen">
        <h1 id="game-title-intro">FNaF: UNSETTLED</h1>
    </div>

    <div id="menu-container">
        <h1>FNaF: UNSETTLED</h1>
        <button class="btn-jogar" onclick="iniciarJogo()">ENTRAR NO TURNO</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <script>
        let scene, camera, renderer, door, arm, room;

        function init3D() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // Luz Inicial
            const light = new THREE.PointLight(0xffffff, 1, 10);
            light.position.set(0, 2, 0);
            scene.add(light);

            // PORTA E BRAÇO (Igual ao anterior)
            const doorGroup = new THREE.Group();
            const doorMesh = new THREE.Mesh(new THREE.BoxGeometry(2.2, 4, 0.1), new THREE.MeshStandardMaterial({ color: 0x1a0a00 }));
            doorMesh.position.set(1.1, 0, 0);
            doorGroup.add(doorMesh);
            doorGroup.position.set(-1.1, 0, -3);
            scene.add(doorGroup);
            window.doorGroup = doorGroup;

            const armMesh = new THREE.Mesh(new THREE.CylinderGeometry(0.1, 0.15, 1.2), new THREE.MeshStandardMaterial({ color: 0x222222 }));
            armMesh.rotation.x = Math.PI/2.5; armMesh.position.set(0.6, -1.5, 1);
            scene.add(armMesh);
            window.arm = armMesh;

            camera.position.z = 2;
            animate();
        }

        function criarSalaPrincipal() {
            // Criando o "Salão Principal" em 3D
            const roomGroup = new THREE.Group();
            
            // Chão de Xadrez (Textura gerada por código)
            const floorGeo = new THREE.PlaneGeometry(20, 30);
            const floorMat = new THREE.MeshStandardMaterial({ color: 0xffffff, side: THREE.DoubleSide });
            const floor = new THREE.Mesh(floorGeo, floorMat);
            floor.rotation.x = Math.PI / 2;
            floor.position.y = -2;
            roomGroup.add(floor);

            // Paredes Sujas
            const wallMat = new THREE.MeshStandardMaterial({ color: 0x333333 });
            const backWall = new THREE.Mesh(new THREE.PlaneGeometry(20, 10), wallMat);
            backWall.position.set(0, 3, -15);
            roomGroup.add(backWall);

            // Luzes de Neon piscando no teto
            const neon = new THREE.PointLight(0x660000, 0.5, 15);
            neon.position.set(0, 4, -5);
            roomGroup.add(neon);

            roomGroup.position.z = -20; // Fica escondida até a transição
            scene.add(roomGroup);
            window.mainRoom = roomGroup;
        }

        function iniciarJogo() {
            document.getElementById('menu-container').style.display = 'none';

            // Animação de Entrada
            new TWEEN.Tween(window.arm.position).to({ y: -0.2, z: -2.5 }, 1000).start();
            
            setTimeout(() => {
                new TWEEN.Tween(window.doorGroup.rotation).to({ y: -Math.PI / 2 }, 1500).start();
                new TWEEN.Tween(camera.position).to({ z: -8 }, 3000).onComplete(transicaoPreta).start();
            }, 1000);
        }

        function transicaoPreta() {
            const black = document.getElementById('black-screen');
            const title = document.getElementById('game-title-intro');
            
            black.style.display = 'flex';
            setTimeout(() => black.style.opacity = '1', 10);

            setTimeout(() => {
                title.style.display = 'block';
                // Remove a porta velha e coloca o Michael na sala nova
                scene.remove(window.doorGroup);
                window.mainRoom.position.z = 0; 
                camera.position.set(0, 0, 5);
            }, 2000);

            setTimeout(() => {
                title.style.opacity = '0';
                setTimeout(() => {
                    black.style.opacity = '0';
                    setTimeout(() => black.style.display = 'none', 2000);
                }, 1000);
            }, 5000);
        }

        function animate() {
            requestAnimationFrame(animate);
            TWEEN.update();
            renderer.render(scene, camera);
        }

        init3D();
        criarSalaPrincipal();
    </script>
</body>
</html>
