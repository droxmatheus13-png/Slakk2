<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noite dos Mistérios</title>
    <style>
        :root {
            --dark-blue: #0a0e14;
            --gold: #d4af37;
            --blood: #880808;
        }
        body {
            background-color: var(--dark-blue);
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }
        #tela-inicial, #tela-jogo {
            width: 100%;
            max-width: 500px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        h1 { color: var(--gold); text-shadow: 2px 2px 5px black; }
        .btn {
            background: var(--gold);
            border: none;
            padding: 15px 30px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px;
            margin: 10px;
        }
        /* Roleta */
        #roleta-container { display: none; margin: 20px; }
        #roleta {
            width: 200px; height: 200px;
            border: 5px solid var(--gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 3s cubic-bezier(0.1, 0, 0.1, 1);
            background: conic-gradient(red 0% 16%, blue 16% 32%, green 32% 48%, purple 48% 64%, orange 64% 80%, gray 80% 100%);
        }
        /* Chat e Log */
        #chat {
            width: 90%; height: 300px;
            background: rgba(255,255,255,0.1);
            margin: 10px; padding: 10px;
            overflow-y: auto; text-align: left;
            border-radius: 10px; font-size: 14px;
        }
        .status-bar { font-size: 12px; color: var(--gold); margin-bottom: 5px; }
        .escondido { display: none !important; }
    </style>
</head>
<body>

    <div id="tela-inicial">
        <h1>Noite dos Mistérios</h1>
        <p>A cidade dorme... mas quem acordará?</p>
        <button class="btn" onclick="iniciarSorteio()">INICIAR RODADA</button>
    </div>

    <div id="roleta-container">
        <h2>Sorteando seu papel...</h2>
        <div id="roleta">?</div>
        <h3 id="papel-sorteado"></h3>
        <button id="btn-comecar-cidade" class="btn escondido" onclick="entrarNaCidade()">ENTRAR NA CIDADE</button>
    </div>

    <div id="tela-jogo" class="escondido">
        <div class="status-bar">
            Jogadores: <span id="count-jogadores">18</span> | 
            Mortes: <span id="count-mortes">0</span> |
            Papel: <b id="meu-papel-display"></b>
        </div>
        <div id="chat"></div>
        <input type="text" id="input-chat" placeholder="Faça uma pergunta..." style="width: 80%; padding: 10px;">
        <button class="btn" onclick="enviarMensagem()">Enviar</button>
        <div id="acoes-bruxa" class="escondido">
            <button class="btn" style="background:purple" onclick="usarPocao()">Usar Poção Mágica</button>
        </div>
    </div>

    <script>
        const nomes = ["Arthur", "Beatriz", "Caio", "Diana", "Erik", "Flora", "Gustavo", "Helena", "Igor", "Julia", "Kevin", "Lara", "Murilo", "Nina", "Otto", "Paula", "Raul"];
        const papeis = ["Bruxa", "Assassino", "Xerife", "Médico", "Lobisomem", "Cidadão"];
        let meuPapel = "";
        let mortes = 0;
        let jogadoresVivos = 18;

        function iniciarSorteio() {
            document.getElementById('tela-inicial').classList.add('escondido');
            document.getElementById('roleta-container').style.display = 'block';
            
            let r = document.getElementById('roleta');
            r.style.transform = "rotate(1080deg)";
            
            setTimeout(() => {
                meuPapel = papeis[Math.floor(Math.random() * papeis.length)];
                document.getElementById('papel-sorteado').innerText = "Você é: " + meuPapel;
                document.getElementById('btn-comecar-cidade').classList.remove('escondido');
            }, 3000);
        }

        function entrarNaCidade() {
            document.getElementById('roleta-container').classList.add('escondido');
            document.getElementById('tela-jogo').classList.remove('escondido');
            document.getElementById('meu-papel-display').innerText = meuPapel;
            
            adicionarMensagem("Sistema", "A partida começou com 18 jogadores.");
            if(meuPapel === "Bruxa") {
                adicionarMensagem("Mestre", "Bruxa, você quer ser do BEM ou do MAL? (Ação automática simulada)");
            }
            simularTurnoBots();
        }

        function adicionarMensagem(autor, texto) {
            let chat = document.getElementById('chat');
            chat.innerHTML += `<p><strong>${autor}:</strong> ${texto}</p>`;
            chat.scrollTop = chat.scrollHeight;
        }

        function enviarMensagem() {
            let input = document.getElementById('input-chat');
            if(input.value !== "") {
                adicionarMensagem("Você", input.value);
                let botAleatorio = nomes[Math.floor(Math.random() * nomes.length)];
                
                // Resposta obrigatória do Bot
                setTimeout(() => {
                    let respostas = ["Eu sou inocente!", "Estava dormindo.", "Vi o Caio andando por aí...", "Não sei de nada.", "Sou o Médico!"];
                    adicionarMensagem(botAleatorio, respostas[Math.floor(Math.random() * respostas.length)]);
                }, 1000);
                
                input.value = "";
            }
        }

        function simularTurnoBots() {
            setInterval(() => {
                if(jogadoresVivos > 2) {
                    mortes++;
                    jogadoresVivos--;
                    document.getElementById('count-mortes').innerText = mortes;
                    document.getElementById('count-jogadores').innerText = jogadoresVivos;
                    
                    let vitima = nomes.pop();
                    adicionarMensagem("Sistema", `A noite passou. ${vitima} foi eliminado.`);

                    // Lógica da Bruxa (A cada 2, 4 ou 6 mortes)
                    if(meuPapel === "Bruxa" && (mortes == 2 || mortes == 4 || mortes == 6)) {
                        document.getElementById('acoes-bruxa').classList.remove('escondido');
                        adicionarMensagem("Poder", "Você destrancou uma Poção!");
                    }
                }
            }, 10000); // Nova morte a cada 10 segundos para teste
        }

        function usarPocao() {
            const listaPocoes = ["Revelação", "Força", "Manipulação", "Reviver", "+1 Vida"];
            let p = listaPocoes[Math.floor(Math.random() * listaPocoes.length)];
            alert("Você usou a poção de: " + p);
            document.getElementById('acoes-bruxa').classList.add('escondido');
        }
    </script>
</body>
</html>
